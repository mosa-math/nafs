<!doctype html>
<html lang="ar" dir="rtl" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù…Ù†ØµØ© ØªØ¯Ø±ÙŠØ¨ Ù†Ø§ÙØ³ - Ø§Ù„Ø£Ø³ØªØ§Ø° Ù…ÙˆØ³Ù‰ Ø§Ù„ØµØ¨Ø­ÙŠ</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">

  <style>
    * { font-family: 'Tajawal', sans-serif; }
    body { background-color: #e2e8f0; min-height: 100vh; display: flex; flex-direction: column; }

    /* ØªÙ†Ø³ÙŠÙ‚ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø³Ø¤Ø§Ù„ */
    .quiz-container {
      background: white; border-radius: 2rem; box-shadow: 0 10px 25px rgba(0,0,0,0.05);
      width: 100%; max-width: 800px; padding: 2.5rem; position: relative;
    }
    .pill-container { display: flex; gap: 8px; position: absolute; top: -20px; left: 40px; }
    .pill-item {
      background: #dbeafe; color: #1e40af; padding: 8px 20px; border-radius: 1.5rem;
      font-weight: 800; font-size: 0.9rem; display: flex; align-items: center; gap: 5px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    }

    /* Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© */
    .option-card {
      width: 100%; padding: 1.2rem 2rem; background: #f8fafc; border: 2px solid #f1f5f9;
      border-radius: 1.2rem; display: flex; justify-content: space-between; align-items: center;
      font-weight: 700; color: #334155; transition: all 0.2s; cursor: pointer;
    }
    .option-card:hover { border-color: #3b82f6; background: #eff6ff; }
    .option-card.correct { background: #22c55e !important; color: white !important; border-color: #16a34a !important; }
    .option-card.wrong { background: #ef4444 !important; color: white !important; border-color: #dc2626 !important; }

    .progress-bar { height: 8px; background: #e2e8f0; border-radius: 10px; overflow: hidden; margin-top: 10px; }
    .progress-fill { height: 100%; background: #1e3a8a; transition: width 0.3s; }

    /* Toast */
    #feedback-toast {
      position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
      z-index: 9999; padding: 1.5rem 3rem; border-radius: 1.5rem; display: none;
      text-align: center; color: white; font-weight: 900; font-size: 1.5rem;
      animation: pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    @keyframes pop {
      0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
    }
  </style>
</head>

<body class="bg-slate-100 p-4">

<div id="app" class="flex-grow flex items-center justify-center">

  <div id="mainContainer" class="w-full max-w-5xl bg-white rounded-3xl shadow-xl overflow-hidden grid md:grid-cols-2">

    <section id="heroSection" class="p-8 bg-slate-50 flex flex-col items-center text-center border-l">
      <div class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-xs font-bold mb-4">â­ ØªØ¯Ø±ÙŠØ¨ ØªÙØ§Ø¹Ù„ÙŠ</div>

      <!-- Ø§Ù„Ø£ÙØ¶Ù„ Ù…Ø­Ù„ÙŠÙ‹Ø§: moe.png / nafss.png / Ù…Ø¯Ø±Ø³Ø©.png -->
      <div class="flex items-center justify-center gap-3 mb-4">
        <img src="nafss.png" class="w-22" alt="Ù†Ø§ÙØ³">
      </div>

      <p class="text-slate-500 font-bold text-xs uppercase">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„ØªØ¹Ù„ÙŠÙ… Ø¨Ù†Ø¬Ø±Ø§Ù†</p>
      <p class="text-green-800 font-bold text-sm mb-6">Ù…Ø¯Ø±Ø³Ø© Ø¹Ù„ÙŠ Ø¨Ù† Ø£Ø¨ÙŠ Ø·Ø§Ù„Ø¨ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©</p>
      <h1 class="text-2xl font-black text-slate-800 mb-1">Ù…Ù†ØµØ© ØªØ¯Ø±ÙŠØ¨ Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø§ÙØ³</h1>
      <p class="text-xs text-slate-400 font-bold">Ù…Ø§Ø¯Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ù„Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</p>

      <!-- PDF: Ø§Ù„Ø£ÙØ¶Ù„ ØªØºÙŠÙŠØ± Ø§Ù„Ø§Ø³Ù… Ù„Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© -->
      <button onclick="window.open('./plan100.pdf', '_blank')"
        class="mt-4 flex items-center gap-2 px-4 py-2 bg-red-50 text-red-600 border border-red-200 rounded-lg text-xs font-bold hover:bg-red-100 transition-colors">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
        </svg>
        ØªÙˆØ²ÙŠØ¹ Ø®Ø·Ø© Ù¡Ù Ù  ÙŠÙˆÙ… (PDF)
      </button>
    </section>

    <div id="interactiveSection" class="p-10 flex flex-col justify-center">
      <div id="startScreen" class="space-y-6">
        <div class="text-xl font-black">ğŸ‘‹ Ø£Ù‡Ù„Ù‹Ø§ ÙˆØ³Ù‡Ù„Ù‹Ø§ ÙŠØ§ Ø¨Ø·Ù„!</div>
        <p class="text-xs font-bold text-slate-400">Ø§ÙƒØªØ¨ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø«Ù… Ø§Ø®ØªØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ÙˆØ§Ø¶ØºØ· Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ ğŸš€</p>

        <input id="studentName" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§..."
          class="w-full px-4 py-3 rounded-xl border border-slate-200 outline-none focus:ring-2 focus:ring-blue-500">

        <div class="grid grid-cols-2 gap-3">
          <select id="gradeSelect" class="px-4 py-3 rounded-xl border border-slate-200 font-bold">
            <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ</option>
            <option value="Ø³Ø§Ø¯Ø³ ( Ø£ )">Ø³Ø§Ø¯Ø³ ( Ø£ )</option>
            <option value="Ø³Ø§Ø¯Ø³ ( Ø¨ )">Ø³Ø§Ø¯Ø³ ( Ø¨ )</option>
          </select>

          <select id="weekSelect" class="px-4 py-3 rounded-xl border border-slate-200 font-bold">
            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</option>
            <script>
              for(let i=1; i<=10; i++) document.write(`<option value="${i}">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ${i}</option>`)
            </script>
          </select>
        </div>

        <!-- Ø²Ø± Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© -->
        <button onclick="startTraining()" class="w-full py-4 bg-blue-600 text-white font-black rounded-xl text-lg shadow-lg">
          Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ ğŸš€
        </button>
      </div>
    </div>
  </div>

  <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± -->
  <div id="quizScreen" class="hidden w-full flex flex-col items-center">
    <div class="w-full max-w-3xl mb-8">
      <div class="flex justify-between items-center mb-2">
        <div class="flex items-center gap-2 font-bold text-slate-700">
          <span class="bg-slate-200 p-2 rounded-full">ğŸ‘¤</span>
          <span id="displayStudentName"></span>
        </div>
        <div class="font-bold text-slate-500" id="topQIndicator"></div>
      </div>
      <div class="progress-bar"><div id="progressFill" class="progress-fill" style="width: 0%"></div></div>
    </div>

    <div class="quiz-container">
      <div class="pill-container">
        <div class="pill-item"><span>Ø§Ù„Ø³Ø¤Ø§Ù„</span> <span id="currQNum">1</span> Ù…Ù† <span id="totalQNum">0</span></div>
        <div class="pill-item">â±ï¸ Ø§Ù„ÙˆÙ‚Øª: <span id="timer">10:00</span></div>
      </div>

      <h2 id="questionText" class="text-2xl font-extrabold text-slate-800 text-center my-8"></h2>
      <div id="optionsGrid" class="space-y-4"></div>

      <button id="nextBtn" onclick="nextQuestion()" class="hidden w-full py-4 bg-slate-800 text-white font-black rounded-xl mt-8 text-lg">
        Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ â¬…ï¸
      </button>
    </div>
  </div>

  <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù†ØªÙŠØ¬Ø© -->
  <div id="resultScreen" class="hidden w-full max-w-md flex flex-col items-center text-center">
    <div class="text-6xl mb-4">ğŸ†</div>
    <h2 id="resStudentName" class="text-3xl font-black text-blue-900 mb-6"></h2>

    <div class="bg-white w-full rounded-3xl p-8 shadow-xl space-y-6">
      <div class="text-6xl font-black text-slate-800" id="resScoreText"></div>
      <div class="text-2xl font-black text-blue-600" id="resPercent"></div>
      <div class="text-xl font-bold text-slate-700">Ø§Ù„ØªÙ‚Ø¯ÙŠØ±: <span id="resGrade"></span></div>
      <div id="resMsg" class="bg-amber-50 p-3 rounded-xl text-amber-700 font-bold text-sm"></div>
    </div>

    <div class="grid grid-cols-3 gap-3 w-full mt-8">
      <button onclick="printCertificateOnly()" class="bg-green-600 text-white p-3 rounded-xl font-bold text-sm">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©</button>
      <button onclick="location.reload()" class="bg-blue-600 text-white p-3 rounded-xl font-bold text-sm">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø©</button>
      <button onclick="location.reload()" class="bg-slate-800 text-white p-3 rounded-xl font-bold text-sm">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    </div>
  </div>

</div>

<footer id="pageFooter" class="p-6 text-center text-slate-400 font-bold">
  Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¹Ù„Ù…: <span class="text-blue-900">Ù…ÙˆØ³Ù‰ Ø§Ù„ØµØ¨Ø­ÙŠ</span>
</footer>

<div id="feedback-toast"></div>

<script>
  // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
  const WEEKS_DATA = {
    10: [
      { q: "Ø£ÙˆØ¬Ø¯ Ù†Ø§ØªØ¬: Ù£Ù¦Ù¢ Ã— Ù¢Ù¥", c: ["Ù§Ù¢Ù¥Ù ", "Ù¨Ù Ù¥Ù ", "Ù©Ù Ù¥Ù ", "Ù¦Ù¢Ù¥Ù "], correct: 0 },
      { q: "Ø£ÙˆØ¬Ø¯ Ù†Ø§ØªØ¬: Ù¦Ù¨Ù§Ù£Ù¥Ù©Ù¤ âˆ’ Ù£Ù§Ù¦Ù¡Ù¤Ù¥Ù¢", c: ["Ù£Ù¡Ù¡Ù¢Ù¡Ù¤Ù¢", "Ù£Ù Ù¡Ù¢Ù¡Ù¤Ù¢", "Ù£Ù¢Ù¡Ù¡Ù¡Ù¤Ù¢", "Ù£Ù¡Ù¡Ù¡Ù¢Ù¤Ù¢"], correct: 0 },
    ],
    9: [
      { q: "Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„ØªØ§Ø³Ø¹ Ù¡", c: ["Ø£", "Ø¨", "Ø¬", "Ø¯"], correct: 1 },
      { q: "Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„ØªØ§Ø³Ø¹ Ù¢", c: ["Ø£", "Ø¨", "Ø¬", "Ø¯"], correct: 2 },
    ],
    8: [
      { q: "Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù…Ù† Ù¡", c: ["Ø£", "Ø¨", "Ø¬", "Ø¯"], correct: 0 },
    ],
    7: [
      { q: "Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¨Ø¹ Ù¡", c: ["Ø£", "Ø¨", "Ø¬", "Ø¯"], correct: 1 },
      { q: "Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¨Ø¹ Ù¢", c: ["Ø£", "Ø¨", "Ø¬", "Ø¯"], correct: 2 },
    ],
    6: [
      { q: "Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¯Ø³ Ù¡", c: ["Ø£", "Ø¨", "Ø¬", "Ø¯"], correct: 0 },
    ],
    5: [
      { q: "Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø®Ø§Ù…Ø³ Ù¡", c: ["Ø£", "Ø¨", "Ø¬", "Ø¯"], correct: 1 },
      { q: "Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø®Ø§Ù…Ø³ Ù¢", c: ["Ø£", "Ø¨", "Ø¬", "Ø¯"], correct: 2 },
    ],
    4: [
      { q: "Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø±Ø§Ø¨Ø¹ Ù¡", c: ["Ø£", "Ø¨", "Ø¬", "Ø¯"], correct: 0 },
    ],
    3: [
      { q: "Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù„Ø« Ù¡", c: ["Ø£", "Ø¨", "Ø¬", "Ø¯"], correct: 1 },
      { q: "Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù„Ø« Ù¢", c: ["Ø£", "Ø¨", "Ø¬", "Ø¯"], correct: 2 },
    ],
    2: [
      { q: "Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù†ÙŠ Ù¡", c: ["Ø£", "Ø¨", "Ø¬", "Ø¯"], correct: 0 },
    ],
    1: [
      { q: "Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø£ÙˆÙ„ Ù¡", c: ["Ø£", "Ø¨", "Ø¬", "Ø¯"], correct: 1 },
      { q: "Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø£ÙˆÙ„ Ù¢", c: ["Ø£", "Ø¨", "Ø¬", "Ø¯"], correct: 2 },
    ],
  };

  let currentQuestions = [];
  let currentIdx = 0;
  let score = 0;
  let timeLeft = 600;
  let timerId = null;
  let studentData = {};

  function startTraining() {
    const name = document.getElementById('studentName').value.trim();
    const grade = document.getElementById('gradeSelect').value;
    const week = document.getElementById('weekSelect').value;

    if(!name || !grade || !week) {
      alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙˆÙ„Ø§Ù‹!");
      return;
    }

    studentData = { name, grade, week };
    currentQuestions = WEEKS_DATA[week] || [];

    // âœ… Ø´Ø±Ø·: Ù„Ùˆ Ù…Ø§ ÙÙŠÙ‡ Ø£Ø³Ø¦Ù„Ø©
    if(!currentQuestions.length){
      alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ø¦Ù„Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹.");
      return;
    }

    // Reset
    currentIdx = 0;
    score = 0;
    timeLeft = 600;
    if(timerId) clearInterval(timerId);

    document.getElementById('mainContainer').classList.add('hidden');
    document.getElementById('pageFooter').classList.add('hidden');
    document.getElementById('quizScreen').classList.remove('hidden');

    document.getElementById('displayStudentName').innerText = name;

    startTimer();
    loadQuestion();
  }

  function startTimer() {
    timerId = setInterval(() => {
      timeLeft--;
      let mins = Math.floor(timeLeft / 60), secs = timeLeft % 60;
      document.getElementById('timer').innerText = `${String(mins).padStart(2,'0')}:${String(secs).padStart(2,'0')}`;
      if(timeLeft <= 0) endQuiz();
    }, 1000);
  }

  function loadQuestion() {
    const q = currentQuestions[currentIdx];
    document.getElementById('currQNum').innerText = currentIdx + 1;
    document.getElementById('totalQNum').innerText = currentQuestions.length;
    document.getElementById('topQIndicator').innerText = `Ø§Ù„Ø³Ø¤Ø§Ù„ ${currentIdx + 1} Ù…Ù† ${currentQuestions.length}`;
    document.getElementById('questionText').innerText = q.q;

    document.getElementById('progressFill').style.width = `${((currentIdx + 1) / currentQuestions.length) * 100}%`;

    const grid = document.getElementById('optionsGrid');
    grid.innerHTML = "";

    const letters = ['Ø£', 'Ø¨', 'Ø¬', 'Ø¯'];
    q.c.forEach((choice, i) => {
      const card = document.createElement('div');
      card.className = "option-card";
      card.innerHTML = `<span>${choice}</span><span class="text-slate-300 font-black">${letters[i]}</span>`;
      card.onclick = () => checkAnswer(i, card);
      grid.appendChild(card);
    });

    document.getElementById('nextBtn').classList.add('hidden');
  }

  function checkAnswer(idx, card) {
    const q = currentQuestions[currentIdx];
    const toast = document.getElementById('feedback-toast');

    if(idx === q.correct) {
      score++;
      card.classList.add('correct');
      toast.innerText = "Ù…Ù…ØªØ§Ø²! ğŸ¥³";
      toast.style.background = "#22c55e";
    } else {
      card.classList.add('wrong');
      toast.innerText = "Ø®Ø§Ø·Ø¦Ø©! ğŸ’”";
      toast.style.background = "#ef4444";
    }

    toast.style.display = "block";
    setTimeout(() => toast.style.display = "none", 1000);

    document.querySelectorAll('.option-card').forEach(c => c.style.pointerEvents = "none");
    document.getElementById('nextBtn').classList.remove('hidden');
  }

  function nextQuestion() {
    currentIdx++;
    if(currentIdx < currentQuestions.length) loadQuestion();
    else endQuiz();
  }

  function endQuiz() {
    if(timerId) clearInterval(timerId);

    document.getElementById('quizScreen').classList.add('hidden');
    document.getElementById('resultScreen').classList.remove('hidden');

    const p = Math.round((score / currentQuestions.length) * 100);

    document.getElementById('resStudentName').innerText = studentData.name;
    document.getElementById('resScoreText').innerText = `${score} Ù…Ù† ${currentQuestions.length}`;
    document.getElementById('resPercent').innerText = `${p}%`;

    document.getElementById('resGrade').innerText =
      p >= 90 ? "Ù…Ù…ØªØ§Ø²" : p >= 75 ? "Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹" : "ÙŠØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†";

    document.getElementById('resMsg').innerText =
      p >= 75 ? "Ø£Ù†Øª Ø¨Ø·Ù„ Ø­Ù‚ÙŠÙ‚ÙŠ! Ø§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ ğŸŒŸ" : "Ù†Ø´Ø¬Ø¹Ùƒ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„ØªØ­Ø³ÙŠÙ† Ù†ØªÙŠØ¬ØªÙƒ! ğŸ’ª";
  }

  function printCertificateOnly() {
    const name = (document.getElementById('resStudentName')?.innerText || '').trim();
    const percent = (document.getElementById('resPercent')?.innerText || '').trim();
    const scoreText = (document.getElementById('resScoreText')?.innerText || '').trim();

    const cls = document.getElementById('gradeSelect')?.value || '';
    const week = document.getElementById('weekSelect')?.value || '';

    const options = { year: 'numeric', month: 'long', day: 'numeric', calendar: 'islamic-uma' };
    const dateStr = new Date().toLocaleDateString('ar-SA', options);

    const ministryLogo = "moe.png";
    const nafsLogo     = "nafss.png";
    const schoolLogo   = "Ù…Ø¯Ø±Ø³Ø©.png";

    const iframe = document.createElement('iframe');
    iframe.style.position = 'fixed';
    iframe.style.right = '0';
    iframe.style.bottom = '0';
    iframe.style.width = '0';
    iframe.style.height = '0';
    iframe.style.border = '0';
    document.body.appendChild(iframe);

    const doc = iframe.contentWindow.document;
    doc.open();
    doc.write(`<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<title>Ø·Ø¨Ø§Ø¹Ø© Ø´Ù‡Ø§Ø¯Ø©</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
<style>
  @page { size: A4 landscape; margin: 0; }
  html, body { margin:0; padding:0; background:#fff; }
  body { display:flex; }

  .cert-box{
    width: 297mm; height: 210mm;
    box-sizing: border-box;
    padding: 14mm;
    border: 6mm double #1e3a8a;
    background:#fff;
    text-align:center;
    direction:rtl;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
    font-family: "Tajawal", Tahoma, Arial, sans-serif;
  }

  .top{ display:flex; justify-content:space-between; align-items:center; gap:10mm; }
  .top img{ height:26mm; width:auto; display:block; }

  h1{ font-size:54px; color:#1e3a8a; font-weight:900; margin:6mm 0 0; }
  p{ font-size:30px; margin-top:12mm; margin-bottom:6mm; }

  h2{
    font-size:60px; color:#000;
    border-bottom:5px solid #d4af37;
    display:inline-block;
    padding:0 22mm;
    margin:6mm 0;
    min-height:1.2em;
  }

  .line{ font-size:28px; margin:8px 0; }
  .green{ font-size:26px; color:#059669; font-weight:900; margin-top:8px; }
  .date{ margin-top:10mm; font-weight:bold; font-size:22px; }
  .sign{ margin-top:20mm; display:flex; justify-content:space-between; padding:0 22mm; }
  .sign p{ margin:0 0 6px; }
</style>
</head>
<body>
  <div class="cert-box">
    <div class="top">
      <img src="${ministryLogo}" alt="ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…">
      <img src="${nafsLogo}" alt="Ù†Ø§ÙØ³">
      <img src="${schoolLogo}" alt="Ø§Ù„Ù…Ø¯Ø±Ø³Ø©">
    </div>

    <h1>Ø´Ù‡Ø§Ø¯Ø© Ø´ÙƒØ± ÙˆØªÙ‚Ø¯ÙŠØ±</h1>

    <p>ÙŠØªÙ‚Ø¯Ù… Ù…Ø¹Ù„Ù… Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø¨Ù…Ø¯Ø±Ø³Ø© Ø¹Ù„ÙŠ Ø¨Ù† Ø£Ø¨ÙŠ Ø·Ø§Ù„Ø¨ Ø¨Ø®Ø§Ù„Øµ Ø§Ù„Ø´ÙƒØ± Ù„Ù„Ø·Ø§Ù„Ø¨:</p>
    <h2>${escapeHtml(name || "__________")}</h2>

    <div class="line">Ø¨Ø§Ù„ØµÙ: <b>${escapeHtml(cls || "__________")}</b> â€¢ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹: <b>${escapeHtml(week || "â€”")}</b></div>
    <div class="green">Ù„Ø§Ø¬ØªÙŠØ§Ø²Ù‡ ØªØ¯Ø±ÙŠØ¨Ø§Øª Ù†Ø§ÙØ³ Ø¨Ù†Ø³Ø¨Ø© Ø¥Ù†Ø¬Ø§Ø²: <span>${escapeHtml(percent || "â€”")}</span></div>
    <div class="line">Ø§Ù„Ø¯Ø±Ø¬Ø©: <b>${escapeHtml(scoreText || "â€”")}</b></div>
    <div class="date">Ø¨ØªØ§Ø±ÙŠØ®: <span>${escapeHtml(dateStr)}</span> Ù‡Ù€</div>

    <div class="sign">
      <div><p>Ù…Ø¹Ù„Ù… Ø§Ù„Ù…Ø§Ø¯Ø©</p><b>Ø£/ Ù…ÙˆØ³Ù‰ Ø§Ù„ØµØ¨Ø­ÙŠ</b></div>
      <div><p>Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</p><b>Ø£/ Ù†ÙˆØ§Ù Ø¢Ù„ Ø¬Ø§ÙÙ„Ø©</b></div>
    </div>
  </div>

  <script>
    window.onload = () => { window.print(); };
  <\/script>
</body>
</html>`);
    doc.close();

    setTimeout(() => {
      iframe.contentWindow.focus();
      iframe.contentWindow.print();
      setTimeout(() => document.body.removeChild(iframe), 1200);
    }, 400);
  }

  function escapeHtml(str){
    return String(str)
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  window.printCertificateOnly = printCertificateOnly;
  window.startTraining = startTraining;
</script>

</body>
</html>
